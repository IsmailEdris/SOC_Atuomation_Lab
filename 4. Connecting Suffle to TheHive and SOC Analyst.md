# Objective

The objective of this step is to integrate Shuffle, a security automation platform, to efficiently send alerts to TheHive, and notify SOC analysts via email. Shuffle is a low-code, open-source security orchestration, automation, and response (SOAR) platform designed to streamline workflows and enhance incident response capabilities.

## Step 1: Integrating Wazuh with Shuffle

This step focused on creating a Shuffle workflow to automate the processing of Wazuh alerts. A webhook was configured to send Wazuh alerts to Shuffle, and the `ossec.conf` file on the Wazuh server was updated to forward alerts in JSON format. The changes were verified by viewing the alerts in the Shuffle dashboard.

---

### Steps Performed

#### 1. Created a Shuffle Workflow
- A new Shuffle workflow titled **"SOC Automation Project"** was created. Within this workflow.

![afdf](https://i.imgur.com/ApEBwcK.png)


- A webhook was configured to receive Wazuh alerts.

> Webhook configuration

![afdaf](https://i.imgur.com/WNGiidp.png)

- The Shuffle tool was set to repeat back the received alerts by modifying the "call" to "executions."

> Shuffle Tool configuration

![afdsfa](https://i.imgur.com/u7IPJS9.png)


---

#### 2. Configured `ossec.conf` on the Wazuh Server
The `ossec.conf` file on the Wazuh server was updated to forward alerts to Shuffle. The following integration block was added to the configuration file:

```xml
<integration>
  <name>shuffle</name>
  <hook_url>https://shuffler.io/api/v1/hooks/webhook_12fdc7ed-c7de-4d1b-aa84-c2411d86d164</hook_url>
  <rule_id>100002</rule_id>
  <alert_format>json</alert_format>
</integration>

```

![afdaf](https://i.imgur.com/oazFQKh.png)

#### Explanation of Each Tag:

- **`<name>`**: Specifies the name of the integration. Here, "shuffle" is used to indicate that the alerts will be sent to the Shuffle platform.
- **`<hook_url>`**: The webhook URL where Wazuh sends the alerts. This URL corresponds to the webhook configured in the Shuffle workflow.
- **`<rule_id>`**: Specifies the rule ID to filter the alerts being sent. In this case, `100002` is used to only send alerts related to the custom Mimikatz rule.
- **`<alert_format>`**: Defines the format of the alerts. Setting this to `json` ensures that the alerts are sent in JSON format, which is compatible with Shuffle.


#### 3. Restarted and Verified the Wazuh Manager
After updating the `ossec.conf` file, the Wazuh Manager was restarted to apply the changes.

#### Commands Executed:
```bash
# Restart the Wazuh Manager
systemctl restart wazuh-manager.service

# Check the status of the Wazuh Manager
systemctl status wazuh-manager.service

```

#### 4. Verified Alerts in the Shuffle Dashboard
After configuring the Wazuh Manager and setting up the integration, the Shuffle dashboard was used to verify that alerts were being received.

![afadfa](https://i.imgur.com/cUvv7Qy.png)

#### Steps Taken:
- Navigated to the Shuffle dashboard.
- Confirmed that Wazuh alerts were successfully received through the webhook integration.
- Reviewed the alert details, including:
  - **Severity**: Indicates the importance of the alert (e.g., high severity for Mimikatz detection).
  - **Pretext**: Displays `"Wazuh Alert"` to provide context for the alert.
  - **Title**: Shows `"Mimikatz Usage Detected"` for clarity on what triggered the alert.
  - **Rule ID**: Displays `100002`, which corresponds to the custom rule for detecting Mimikatz activity.
  - **MITRE ID**: Shows `T1003`, aligning the alert with the MITRE ATT&CK framework for credential dumping techniques.
  - **Timestamp**: Logs the exact time the alert was generated.

This verification confirmed that alerts were successfully forwarded from Wazuh to Shuffle and displayed correctly in the dashboard.


